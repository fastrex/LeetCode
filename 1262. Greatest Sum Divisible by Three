class Solution {
public:
    int maxSumDivThree(vector<int>& nums) {
        std::sort(nums.begin(), nums.end());
        int max_ = std::numeric_limits<int>::max();
        int n1 = max_;
        int n2 = max_;
        int sum1 = max_;
        int sum2 = max_;      
        int sum = 0;
        for (int& n : nums)
        {
            if (sum1 == n1 && n % 3 == 1)
            {
                n1 = n1 == max_ ? n : n1;
                sum1 = sum1 == max_ ? n : sum1 + n;                
            }
            else if (sum2 == n2 && n % 3 == 2)
            {
                n2 = n2 == max_ ? n : n2;
               sum2 = sum2 == max_ ? n : sum2 + n;             
            }
            sum += n;
        }       
        int res = sum % 3;
        if (!res)
        {
            return sum;
        }
        // каждое число прогнать через % 3.
        // если невязка 1, то надо вычесть 1 или 2 раза по 2.
        // если невязка 2, то надо вычесть 2 или 2 раза по 1.
        if (res == 1)
        {           
            if (n2 != max_ && sum2 != n2)
            {
                return sum - (n1 != max_ ? std::min(n1, sum2) : sum2);
            }
            if (n1 != max_)
            {
                return sum - n1;
            }     
            return 0;      
        }
        if (n1 != max_ && sum1 != n1)
        {
            return sum - (n2 != max_ ? std::min(n2, sum1) : sum1);
        }
        if (n2 != max_)
        {
            return sum - n2;
        }     
        return 0;
    }
};
